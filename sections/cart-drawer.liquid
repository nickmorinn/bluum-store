{% liquid
  assign shipping_protection_product = nil
  assign shipping_protection_variant = nil
  assign shipping_protection_in_cart = false
  assign shipping_protection_quantity = 0

  if settings.show_shipping_protection
    if settings.product_shipping_protection != blank
      assign shipping_protection_product = all_products[settings.product_shipping_protection]
    endif

    if shipping_protection_product == nil
      assign shipping_protection_product = all_products['shipping-insurance']
    endif

    if shipping_protection_product == nil
      assign shipping_protection_product = all_products['shipping-protection']
    endif

    if shipping_protection_product and shipping_protection_product.selected_or_first_available_variant
      assign shipping_protection_variant = shipping_protection_product.selected_or_first_available_variant

      for item in cart.items
        if item.variant_id == shipping_protection_variant.id
          assign shipping_protection_in_cart = true
          assign shipping_protection_quantity = item.quantity
          break
        endif
      endfor
    endif
  endif
%}

<cart-drawer {% if request.design_mode %}handle-section-events{% endif %} class="cart-drawer drawer drawer--lg" id="cart-drawer">
  {%- if cart.item_count == 0 -%}
    <button is="close-button" aria-label="{{ 'general.accessibility.close' | t | escape }}">
      {%- render 'icon' with 'close' -%}
    </button>

    <div class="empty-state align-self-center">
      <div class="empty-state__icon-wrapper">
        {%- render 'icon' with 'cart', width: 32, height: 32, stroke_width: 1 -%}
        <span class="count-bubble count-bubble--lg">0</span>
      </div>

      <div class="prose">
        <p class="h5">{{ 'cart.general.empty' | t }}</p>

        {%- assign button_content = 'cart.general.continue_shopping' | t -%}
        {%- render 'button', href: settings.cart_empty_button_link, size: 'xl', content: button_content -%}
      </div>
    </div>
  {%- else -%}
    <div class="cart-drawer__inner">
      {%- if shipping_protection_variant -%}
        <form
          id="ShippingProtectionForm"
          class="shipping-protection-form"
          action="{{ routes.cart_add_url }}.js"
          method="post"
          style="display: none;"
        >
          <input type="hidden" name="id" value="{{ shipping_protection_variant.id }}">
          <input type="hidden" name="quantity" value="1">
        </form>
      {%- endif -%}

      <div class="cart-drawer__top">
        <div class="h-stack items-center justify-between">
          <div class="h-stack grow gap-2 sm:gap-2.5">
            <p class="h5">{{- 'cart.general.title' | t -}}</p>
            <cart-count class="count-bubble count-bubble--md">{{ cart.item_count | minus: shipping_protection_quantity }}</cart-count>
          </div>

          <button type="button" is="close-button" class="drawer__close-icon">
            <span class="sr-only">{{ 'general.accessibility.close' | t }}</span>
            {%- render 'icon' with 'close' -%}
          </button>
        </div>

        {%- if settings.cart_show_free_shipping_threshold -%}
          {%- render 'free-shipping-bar' -%}
        {%- endif -%}

        {%- if section.settings.show_cart_tier_progress -%}
          {%- assign shipping_label = section.settings.shipping_tier_label | default: settings.shipping_tier_label | default: 'free shipping' -%}
          {%- assign gift_label = section.settings.gift_tier_label | default: 'Free reconstitution solution' -%}
          {%- assign shipping_threshold = section.settings.free_shipping_threshold | default: 0 -%}
          {%- assign shipping_threshold_amount = shipping_threshold | times: 100 -%}
          {%- assign show_gift_tier = false -%}
          {%- if section.settings.enable_reconstitution_reward and section.settings.free_reconstitution_threshold > shipping_threshold -%}
            {%- assign show_gift_tier = true -%}
          {%- endif -%}
          {%- if shipping_threshold_amount > 0 -%}
            {%- assign reward_goal_amount = shipping_threshold_amount -%}
            {%- if show_gift_tier -%}
              {%- assign gift_threshold = section.settings.free_reconstitution_threshold | default: shipping_threshold -%}
              {%- assign reward_goal_amount = gift_threshold | times: 100 -%}
            {%- endif -%}
            {%- assign cart_total = cart.total_price -%}
            {%- assign capped_total = cart_total -%}
            {%- if reward_goal_amount > 0 and capped_total > reward_goal_amount -%}
              {%- assign capped_total = reward_goal_amount -%}
            {%- endif -%}
            {%- assign progress_percent = 0 -%}
            {%- if reward_goal_amount > 0 -%}
              {%- assign progress_percent = capped_total | times: 100 | divided_by: reward_goal_amount -%}
            {%- endif -%}
            {%- if progress_percent > 100 -%}
              {%- assign progress_percent = 100 -%}
            {%- endif -%}

            {%- assign shipping_percent = 100 -%}
            {%- if show_gift_tier and reward_goal_amount > 0 -%}
              {%- assign shipping_percent = shipping_threshold_amount | times: 100 | divided_by: reward_goal_amount -%}
              {%- if shipping_percent > 100 -%}
                {%- assign shipping_percent = 100 -%}
              {%- elsif shipping_percent < 0 -%}
                {%- assign shipping_percent = 0 -%}
              {%- endif -%}
            {%- endif -%}

            {%- assign shipping_remaining = shipping_threshold_amount | minus: cart_total -%}
            {%- if shipping_remaining < 0 -%}
              {%- assign shipping_remaining = 0 -%}
            {%- endif -%}

            {%- assign gift_remaining = 0 -%}
            {%- if show_gift_tier -%}
              {%- assign gift_remaining = reward_goal_amount | minus: cart_total -%}
              {%- if gift_remaining < 0 -%}
                {%- assign gift_remaining = 0 -%}
              {%- endif -%}
            {%- endif -%}

            {%- assign progress_icon = 'shipping' -%}
            {%- if show_gift_tier -%}
              {%- if gift_remaining == 0 -%}
                {%- assign progress_icon = 'gift' -%}
              {%- elsif shipping_remaining == 0 -%}
                {%- assign progress_icon = 'gift' -%}
              {%- endif -%}
            {%- endif -%}

            <div class="cart-tier-progress" aria-live="polite">
              <p class="cart-tier-progress__message">
                <span class="cart-tier-progress__message-icon" aria-hidden="true">
                  {%- if progress_icon == 'gift' -%}
                    <svg viewBox="0 0 24 24" width="18" height="18" role="presentation">
                      <path d="M4 8h16v12H4z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                      <path d="M12 4v16M4 12h16" fill="none" stroke="currentColor" stroke-width="1.5"/>
                      <path d="M10 4a2 2 0 1 0-4 2v2h4V4Zm4 0a2 2 0 1 1 4 2v2h-4V4Z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                  {%- else -%}
                    <svg viewBox="0 0 24 24" width="18" height="18" role="presentation">
                      <path d="M3 6h11v9H3zM14 10h4.586a1 1 0 0 1 .707.293l2.414 2.414A1 1 0 0 1 22 13.414V15h-4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                      <circle cx="7" cy="17" r="2" fill="none" stroke="currentColor" stroke-width="1.5"/>
                      <circle cx="17" cy="17" r="2" fill="none" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                  {%- endif -%}
                </span>
                <span>
                  {%- if show_gift_tier and gift_remaining == 0 -%}
                    You've unlocked {{ gift_label | downcase }}!
                  {%- elsif shipping_remaining == 0 -%}
                    {%- if show_gift_tier -%}
                      Add {{ gift_remaining | money_without_trailing_zeros }} more to unlock {{ gift_label | downcase }}
                    {%- else -%}
                      You've unlocked {{ shipping_label | downcase }}!
                    {%- endif -%}
                  {%- else -%}
                    Add {{ shipping_remaining | money_without_trailing_zeros }} more to unlock {{ shipping_label | downcase }}
                  {%- endif -%}
                </span>
              </p>

              <div class="cart-tier-progress__track">
                <span class="cart-tier-progress__fill" style="width: {{ progress_percent }}%;"></span>
              </div>
            </div>
          {%- endif -%}
        {%- endif -%}
      </div>

      <div class="v-stack gap-6 sm:gap-8">
        <div class="cart-drawer__line-items">
          {%- for line_item in cart.items -%}
            {%- if shipping_protection_variant and line_item.variant_id == shipping_protection_variant.id -%}
              {%- continue -%}
            {%- endif -%}
            {%- render 'line-item', line_item: line_item, show_desktop_quantity: true -%}
          {%- endfor -%}
        </div>

        {%- if section.settings.products.count > 0 -%}
          <div class="cart-drawer__recommendations">
            <div class="v-stack gap-2.5 sm:gap-4">
              {%- capture carousel_id -%}cart-drawer-recommendations{%- endcapture -%}

              {%- liquid
                assign horizontal_products_blends = true
                assign product_card_background = section.settings.product_card_background | default: product.settings.product_card_background

                if product_card_background != 'rgba(0,0,0,0)' and product_card_background != blank and product_card_background != settings.dialog_background
                  assign horizontal_products_blends = false
                endif

                assign rendered_recommendations = 0

                capture recommendations
                  for recommended_product in section.settings.products
                    assign item_count_in_cart = cart | line_items_for: recommended_product

                    if item_count_in_cart.size == 0
                      render 'horizontal-product', product: recommended_product, show_add_to_cart: true, background: section.settings.product_card_background, text_color: section.settings.product_card_text_color
                      assign rendered_recommendations = rendered_recommendations | plus: 1
                    endif
                  endfor
                endcapture
              -%}

              {%- if rendered_recommendations > 0 -%}
                <div class="h-stack justify-between gap-4">
                  {%- if section.settings.recommendations_title != blank -%}
                    <p>{{ section.settings.recommendations_title | escape }}</p>
                  {%- endif -%}

                  {%- if rendered_recommendations > 1 -%}
                    <div class="h-stack gap-2 hidden sm:flex">
                      <button is="prev-button" class="circle-chevron hover:colors" aria-controls="{{ carousel_id }}" aria-label="{{ 'general.accessibility.previous' | t | escape }}" disabled>{%- render 'icon' with 'chevron-left-small', direction_aware: true -%}</button>
                      <button is="next-button" class="circle-chevron hover:colors" aria-controls="{{ carousel_id }}" aria-label="{{ 'general.accessibility.next' | t | escape }}">{%- render 'icon' with 'chevron-right-small', direction_aware: true -%}</button>
                    </div>
                  {%- endif -%}
                </div>
              {%- endif -%}

              {%- if recommendations != blank -%}
                <scroll-carousel selector=".horizontal-product" id="{{ carousel_id }}" class="horizontal-product-list-carousel {% unless horizontal_products_blends %}separate{% endunless %} scroll-area bleed">
                  <div class="horizontal-product-list {% if horizontal_products_blends %}divide-x{% else %}separate{% endif %}">
                    {{- recommendations -}}
                  </div>
                </scroll-carousel>
              {%- endif -%}
            </div>
          </div>
        {%- endif -%}
      </div>
    </div>

    <div class="v-stack gap-4 sm:gap-6" slot="footer">
      <div class="v-stack gap-1">
        {% if shipping_protection_variant %}
          {%- assign shipping_heading = settings.shipping_protection_heading | default: 'Shipping Insurance' -%}

          <div
            class="shipping-protection-card{% if shipping_protection_in_cart %} is-selected{% endif %}"
            data-shipping-protection
            data-variant-id="{{ shipping_protection_variant.id }}"
            data-product-handle="{{ shipping_protection_product.handle }}"
            data-selected="{{ shipping_protection_in_cart }}"
            aria-live="polite"
          >
            <div class="shipping-protection-card__layout">
              <div class="shipping-protection-card__info">
                <div class="shipping-protection-card__icon">
                  {% if settings.shipping_protection_icon != blank %}
                    <img
                      src="{{ settings.shipping_protection_icon | image_url: width: 80 }}"
                      width="40"
                      height="40"
                      loading="lazy"
                      alt="{{ shipping_heading | escape }}"
                    >
                  {% else %}
                    <img
                      src="https://cdn.shopify.com/s/files/1/0676/6270/8931/files/shipping-insurance.png?v=1752899311"
                      width="40"
                      height="40"
                      loading="lazy"
                      alt="{{ shipping_heading | escape }}"
                    >
                  {% endif %}
                </div>

                <div class="shipping-protection-card__content">
                  <p class="bold shipping-protection-card__heading">
                    {{ shipping_heading | escape }}
                    <span class="shipping-protection-card__price">{{ shipping_protection_variant.price | money }}</span>
                  </p>
                </div>
              </div>

              <div class="shipping-protection-card__controls">
                <label class="shipping-protection-card__toggle" aria-label="{{ 'Add shipping protection' | escape }}">
                  <input
                    type="checkbox"
                    class="switch"
                    data-shipping-protection-toggle
                    data-variant-id="{{ shipping_protection_variant.id }}"
                    data-product-handle="{{ shipping_protection_product.handle }}"
                    {% if shipping_protection_in_cart %}checked{% endif %}
                    {% unless shipping_protection_variant.available %}disabled{% endunless %}
                  >
                </label>

                {% unless shipping_protection_variant.available %}
                  <span class="text-xs text-subdued">{{ 'products.product.sold_out' | t }}</span>
                {% endunless %}
              </div>
            </div>
          </div>
        {% endif %}

        {% for discount_application in cart.cart_level_discount_applications %}
          <div class="h-stack gap-4 justify-between">
            <div class="badge">
              {%- render 'icon' with 'discount' -%} {{- discount_application.title -}}
            </div>

            <span class="text-subdued">-{{ discount_application.total_allocated_amount | money }}</span>
          </div>
        {% endfor %}

        <div class="h-stack gap-4 justify-between">
          <span class="h5">{{ 'cart.general.total' | t }}</span>
          <span class="h5">{{- cart.total_price | money_with_currency -}}</span>
        </div>

        {%- if section.settings.show_shipping_text -%}
          {%- if cart.taxes_included and shop.shipping_policy.body != blank -%}
            <p class="text-subdued text-sm">{{ 'cart.general.taxes_included_and_shipping_policy_html' | t: link: shop.shipping_policy.url }}</p>
          {%- elsif cart.taxes_included -%}
            <p class="text-subdued text-sm">{{ 'cart.general.taxes_included_but_shipping_at_checkout' | t }}</p>
          {%- elsif shop.shipping_policy.body != blank -%}
            <p class="text-subdued text-sm">{{ 'cart.general.taxes_and_shipping_policy_at_checkout_html' | t: link: shop.shipping_policy.url }}</p>
          {%- else -%}
            <p class="text-subdued text-sm">{{ 'cart.general.taxes_and_shipping_at_checkout' | t }}</p>
          {%- endif -%}
        {%- endif -%}

        {%- if section.settings.show_cart_note -%}
          <button type="button" class="justify-self-start" aria-controls="cart-drawer-note">
            <span class="link text-sm text-subdued">
              {%- if cart.note == blank -%}
                {{- 'cart.general.add_order_note' | t -}}
              {%- else -%}
                {{- 'cart.general.edit_order_note' | t -}}
              {%- endif -%}
            </span>
          </button>

          <cart-note-dialog id="cart-drawer-note" class="cart-drawer__note">
            <div class="cart-drawer__note-inner">
              <div class="v-stack gap-4 sm:gap-6">
                <p class="h5">{{ 'cart.general.order_note' | t }}</p>

                <cart-note class="v-stack gap-4">
                  {%- assign order_note = 'cart.general.order_note' | t -%}
                  {%- assign order_save_label = 'cart.general.save_note' | t -%}

                  {%- render 'input', name: 'note', multiline: 3, label: order_note, value: cart.note -%}

                  <div class="justify-self-start">
                    {%- render 'button', type: 'button', content: order_save_label, size: 'lg', is: 'close-button', secondary: true -%}
                  </div>
                </cart-note>
              </div>
            </div>
          </cart-note-dialog>
        {%- endif -%}
      </div>

      <form action="{{ routes.cart_url }}" method="POST" class="buy-buttons {% if section.settings.show_checkout_button %}buy-buttons--compact{% endif %}">
        {%- assign checkout_label = 'cart.general.checkout' | t -%}

        <div class="v-stack gap-4">
          <div class="text-sm">
            By checking out, I confirm that I have read, understood and agreed with your <a href="{{ section.settings.terms_of_service_url }}" class="link" target="_blank">Terms of Service</a> and <a href="{{ section.settings.waiver_agreement_url }}" class="link" target="_blank">Waiver Agreement</a>. I certify that these products will not be used on humans.
          </div>

          {%- if section.settings.show_view_cart_button or section.settings.show_checkout_button == false -%}
            <a href="{{ routes.cart_url }}" class="button button--xl {% if section.settings.show_checkout_button %}button--secondary{% endif %}" data-no-instant>
              {{- 'cart.general.view_cart' | t -}}
            </a>
          {%- endif -%}

          {%- if section.settings.show_checkout_button -%}
            <div id="checkout-wrapper" class="w-full">
              {%- render 'button', type: 'submit', content: checkout_label, icon: 'picto-lock', name: 'checkout', size: 'xl', stretch: true -%}
            </div>
            <div class="cart-guarantee" aria-label="30 Day Money Back Guarantee">
              <span class="cart-guarantee__icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" width="22" height="22" fill="currentColor">
                  <path d="M23.6641 52.3985C26.6172 55.375 29.3594 55.3516 32.3126 52.3985L35.9219 48.8125C36.2969 48.461 36.625 48.3203 37.1172 48.3203H42.1797C46.3749 48.3203 48.3204 46.3985 48.3204 42.1797V37.1172C48.3204 36.625 48.461 36.2969 48.8124 35.9219L52.3749 32.3125C55.3749 29.3594 55.3514 26.6172 52.3749 23.6641L48.8124 20.0547C48.461 19.7031 48.3204 19.3516 48.3204 18.8829V13.7969C48.3204 9.625 46.3985 7.6563 42.1797 7.6563H37.1172C36.625 7.6563 36.2969 7.5391 35.9219 7.1875L32.3126 3.6016C29.3594.625 26.6172.6485 23.6641 3.6016L20.0547 7.1875C19.7032 7.5391 19.3516 7.6563 18.8828 7.6563H13.7969C9.6016 7.6563 7.6563 9.5782 7.6563 13.7969V18.8829C7.6563 19.3516 7.5391 19.7031 7.1876 20.0547L3.6016 23.6641C.6251 26.6172.6485 29.3594 3.6016 32.3125L7.1876 35.9219C7.5391 36.2969 7.6563 36.625 7.6563 37.1172V42.1797C7.6563 46.375 9.6016 48.3203 13.7969 48.3203H18.8828C19.3516 48.3203 19.7032 48.461 20.0547 48.8125L23.6641 52.3985ZM24.0391 39.7891C23.3126 39.7891 22.8438 39.5547 22.4923 39.1563L14.6641 30.4609C14.336 30.086 14.1485 29.6172 14.1485 29.125C14.1485 28.0234 14.9923 27.2031 16.1876 27.2031C16.8204 27.2031 17.2891 27.4141 17.711 27.8594L23.9219 34.7266L35.9923 17.7344C36.461 17.0547 36.9297 16.7734 37.7501 16.7734C38.8985 16.7734 39.7188 17.6172 39.7188 18.7188C39.7188 19.1172 39.5547 19.586 39.2969 19.9609L25.6328 39.0625C25.2813 39.5078 24.7423 39.7891 24.0391 39.7891Z"/>
                </svg>
              </span>
              <span class="cart-guarantee__text">30 Day Money Back Guarantee</span>
            </div>
          {%- endif -%}
        </div>
      </form>
    </div>
  {%- endif -%}
</cart-drawer>

<script>
  (() => {
    if (window.__shippingProtectionToggleInitialized) return;
    window.__shippingProtectionToggleInitialized = true;

    const selectors = {
      toggle: '[data-shipping-protection-toggle]',
      container: '[data-shipping-protection]'
    };

    const dispatchCartChange = (baseEvent, cartContent) => {
      document.documentElement.dispatchEvent(
        new CustomEvent('cart:change', {
          bubbles: true,
          detail: { baseEvent, cart: cartContent }
        })
      );
    };

    const prepareSections = () => {
      const sections = [];
      document.documentElement.dispatchEvent(
        new CustomEvent('cart:prepare-bundled-sections', {
          bubbles: true,
          detail: { sections }
        })
      );
      return sections;
    };

    const setLoadingState = (toggle, isLoading) => {
      const wasDisabled = toggle.dataset.baseDisabled || toggle.hasAttribute('disabled');

      if (isLoading) {
        toggle.dataset.baseDisabled = wasDisabled ? 'true' : 'false';
        toggle.disabled = true;
      } else if (toggle.dataset.baseDisabled !== 'true') {
        toggle.disabled = false;
      }
    };

    const syncFromCart = (cart) => {
      document.querySelectorAll(selectors.container).forEach((container) => {
        const variantId = Number(container.dataset.variantId);
        if (!variantId) return;

        const toggle = container.querySelector(selectors.toggle);
        const inCart = cart?.items?.some(
          (item) => item.variant_id === variantId || item.id === variantId
        );

        container.dataset.selected = inCart ? 'true' : 'false';
        container.classList.toggle('is-selected', !!inCart);

        if (toggle) {
          toggle.checked = !!inCart;
        }
      });
    };

    const addProtection = async () => {
      const form = document.getElementById('ShippingProtectionForm');
      if (!form) {
        throw new Error('Shipping protection form is missing.');
      }

      const formData = new FormData(form);
      const sections = prepareSections();

      if (sections.length) {
        formData.set('sections', sections.join(','));
        formData.set('sections_url', window.location.pathname);
      }

      const response = await fetch(form.action, {
        method: 'POST',
        body: formData,
        headers: {
          'X-Requested-With': 'XMLHttpRequest',
          Accept: 'application/json'
        }
      });

      const json = await response.json();
      if (!response.ok) {
        throw new Error(json.description || 'Unable to add shipping protection.');
      }

      const cartContent = await (await fetch(`${Shopify.routes.root}cart.js`)).json();
      cartContent.sections = json.sections;
      dispatchCartChange('shipping-protection:add', cartContent);
      return cartContent;
    };

    const removeProtection = async (variantId) => {
      const sections = prepareSections();
      const payload = {
        updates: {
          [variantId]: 0
        }
      };

      if (sections.length) {
        payload.sections = sections.join(',');
        payload.sections_url = window.location.pathname;
      }

      const response = await fetch(`${Shopify.routes.root}cart/update.js`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      const cartContent = await response.json();
      if (!response.ok) {
        throw new Error(cartContent?.description || 'Unable to remove shipping protection.');
      }

      dispatchCartChange('shipping-protection:remove', cartContent);
      syncFromCart(cartContent);
      return cartContent;
    };

    document.addEventListener('change', async (event) => {
      if (!event.target.matches(selectors.toggle)) return;

      const toggle = event.target;
      const variantId = Number(toggle.dataset.variantId);
      if (!variantId) return;

      setLoadingState(toggle, true);

      try {
        if (toggle.checked) {
          await addProtection();
        } else {
          await removeProtection(variantId);
        }
      } catch (error) {
        console.error('Shipping protection update failed', error);
        toggle.checked = !toggle.checked;
      } finally {
        setLoadingState(toggle, false);
      }
    });

    document.addEventListener('cart:change', (event) => {
      if (!event.detail?.cart) return;
      syncFromCart(event.detail.cart);
    });
  })();
</script>

{% schema %}
{
  "name": "Cart drawer",
  "settings": [
    {
      "type": "paragraph",
      "content": "Cart drawer won't appear to your customers if you have set the cart type to Page in the global theme settings."
    },
    {
      "type": "paragraph",
      "content": "Free shipping bar can be configured in global cart settings."
    },
    {
      "type": "checkbox",
      "id": "show_cart_note",
      "label": "Show cart note",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_shipping_text",
      "label": "Show shipping text",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_view_cart_button",
      "label": "Show view cart button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_checkout_button",
      "label": "Show checkout button",
      "default": true
    },
    {
      "type": "header",
      "content": "Cart rewards progress"
    },
    {
      "type": "checkbox",
      "id": "show_cart_tier_progress",
      "label": "Show rewards progress bar",
      "default": true
    },
    {
      "type": "number",
      "id": "free_shipping_threshold",
      "label": "Free shipping threshold ($)",
      "default": 100
    },
    {
      "type": "text",
      "id": "shipping_tier_label",
      "label": "Shipping reward label",
      "default": "Free shipping"
    },
    {
      "type": "checkbox",
      "id": "enable_reconstitution_reward",
      "label": "Add second tier reward",
      "info": "Enable a second reward, such as a free gift, after the free shipping tier.",
      "default": false
    },
    {
      "type": "number",
      "id": "free_reconstitution_threshold",
      "label": "Second tier threshold ($)",
      "info": "Must be greater than the free shipping threshold.",
      "default": 200
    },
    {
      "type": "text",
      "id": "gift_tier_label",
      "label": "Second tier reward label",
      "default": "Free reconstitution solution"
    },
    {
      "type": "header",
      "content": "Product recommendations"
    },
    {
      "type": "text",
      "id": "recommendations_title",
      "label": "Heading",
      "default": "Trending this month"
    },
    {
      "type": "product_list",
      "id": "products",
      "label": "Recommendations",
      "info": "Suggest additional products to your customers. Recommendations already in the cart are automatically hidden.",
      "limit": 10
    },
    {
      "type": "color",
      "id": "product_card_background",
      "label": "Product card background"
    },
    {
      "type": "color",
      "id": "product_card_text_color",
      "label": "Product card text"
    },
    {
      "type": "header",
      "content": "Legal Documents"
    },
    {
      "type": "url",
      "id": "terms_of_service_url",
      "label": "Terms of Service URL",
      "info": "Link to your Terms of Service document"
    },
    {
      "type": "url",
      "id": "waiver_agreement_url",
      "label": "Waiver Agreement URL",
      "info": "Link to your Waiver Agreement document"
    }
  ]
}
{% endschema %}
